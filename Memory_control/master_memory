module memory_control_3(SR1, SR2, alu_result, op_code, RW, address_out, ram_in, ram_out,reg_data, LDR, STR, STR_in, LDR_out,data_ram, Counter);
input [31:0] SR1, SR2, alu_result;
input [3:0] op_code;
input [31:0] ram_in;
output reg RW, LDR, STR, STR_in, LDR_out;
output reg[31:0] address_out,ram_out;
output reg [31:0] reg_data;
output reg Counter;
wire mux_out, address_input;
wire LDR_1, pc,add_bus;
output reg data_ram;

always@*
begin 
case(op_code)
	4'b1101: //LDR
	begin 
		LDR=1;
		RW=1;
		address_out= add_bus; //assign the output of address bus (mux) to address_out
		data_ram=LDR_out;
		reg_data=mux_out;			
	end
	4'b1110: //STR
	begin
		STR=1;
		RW=0;
		address_out=add_bus;
		STR_in=SR2;
	end
	default: 
	begin 
	Counter=pc;
	address_out= add_bus;
	end

endcase
end


Address_bus AB1(SR1, pc, LDR, STR, add_bus); // add_bus is the output of this module 
LDR_mux LD1(LDR, mux_out,data_ram,alu_result); //mux_out is the output of this module 
RAM RAM1(Enable, RW, Address, In, Out);
PC_access PC1(Clk, Reset, pc);
endmodule
